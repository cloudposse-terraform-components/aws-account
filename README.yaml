name: "aws-account"
github_repo: "cloudposse-terraform-components/aws-account"
description: |-
  This component is responsible for creating or importing a single AWS Account within an AWS Organization.

  Unlike the monolithic `account` component which manages the entire organization hierarchy,
  this component follows the single-resource pattern - it only manages a single AWS account.

  > [!NOTE]
  >
  > This component should be deployed from the **management/root account** as it creates accounts
  > within AWS Organizations.

  ## Key Features

  - **Single-resource pattern**: Manages exactly one AWS account per component instance
  - **Conditional import blocks** (Terraform 1.5+): Easily import existing accounts into Terraform state
  - **Independent lifecycle**: Each account can be managed independently without affecting others
  - **Simple configuration**: Minimal variables required for account creation

usage: |-
  **Stack Level**: Global (deployed in the management/root account)

  This component creates or imports a single AWS account. For managing the entire organization hierarchy,
  see the companion components: `aws-organization`, `aws-organizational-unit`, `aws-account-settings`, and `aws-scp`.

  ### Basic Usage

  ```yaml
  components:
    terraform:
      aws-account/core-analytics:
        metadata:
          component: aws-account
        vars:
          name: core-analytics
          account_email: "aws+myorg-core-analytics@example.com"
          parent_id: "ou-xxxx-xxxxxxxx"
  ```

  ### Using Remote State for Parent ID

  Reference the parent OU dynamically using Atmos remote state:

  ```yaml
  components:
    terraform:
      aws-account/core-analytics:
        metadata:
          component: aws-account
        vars:
          name: core-analytics
          account_email: "aws+myorg-core-analytics@example.com"
          parent_id: !terraform.output aws-organizational-unit/core organizational_unit_id
  ```

  ### Importing an Existing Account

  To import an existing AWS account into Terraform state:

  ```yaml
  components:
    terraform:
      aws-account/core-analytics:
        metadata:
          component: aws-account
        vars:
          name: core-analytics
          account_email: "aws+myorg-core-analytics@example.com"
          parent_id: "ou-xxxx-xxxxxxxx"
          import_account_id: "123456789012"
  ```

  After the import succeeds, you can remove the `import_account_id` variable.

  ### Using Catalog Defaults

  Create a defaults file for consistent configuration:

  ```yaml
  # stacks/catalog/aws-account/defaults.yaml
  components:
    terraform:
      aws-account/defaults:
        metadata:
          component: aws-account
          type: abstract
        vars:
          enabled: true
          iam_user_access_to_billing: DENY
          close_on_deletion: false
  ```

  Then inherit from defaults:

  ```yaml
  # stacks/orgs/myorg/core/root/global-region.yaml
  import:
    - catalog/aws-account/defaults

  components:
    terraform:
      aws-account/core-analytics:
        metadata:
          component: aws-account
          inherits:
            - aws-account/defaults
        vars:
          name: core-analytics
          account_email: "aws+myorg-core-analytics@example.com"
          parent_id: !terraform.output aws-organizational-unit/core organizational_unit_id
  ```

  ### Complete Example with Multiple Accounts

  ```yaml
  components:
    terraform:
      # Core OU Accounts
      aws-account/core-analytics:
        metadata:
          component: aws-account
          inherits:
            - aws-account/defaults
        vars:
          name: core-analytics
          account_email: "aws+myorg-core-analytics@example.com"
          parent_id: !terraform.output aws-organizational-unit/core organizational_unit_id
          import_account_id: "111111111111"

      aws-account/core-security:
        metadata:
          component: aws-account
          inherits:
            - aws-account/defaults
        vars:
          name: core-security
          account_email: "aws+myorg-core-security@example.com"
          parent_id: !terraform.output aws-organizational-unit/core organizational_unit_id
          import_account_id: "222222222222"

      # Platform OU Accounts
      aws-account/plat-dev:
        metadata:
          component: aws-account
          inherits:
            - aws-account/defaults
        vars:
          name: plat-dev
          account_email: "aws+myorg-plat-dev@example.com"
          parent_id: !terraform.output aws-organizational-unit/plat organizational_unit_id
          import_account_id: "333333333333"

      aws-account/plat-prod:
        metadata:
          component: aws-account
          inherits:
            - aws-account/defaults
        vars:
          name: plat-prod
          account_email: "aws+myorg-plat-prod@example.com"
          parent_id: !terraform.output aws-organizational-unit/plat organizational_unit_id
          import_account_id: "444444444444"
  ```

  ## Related Components

  This component is part of a suite of single-resource components for AWS Organizations:

  | Component | Purpose |
  |-----------|---------|
  | `aws-organization` | Creates/imports the AWS Organization |
  | `aws-organizational-unit` | Creates/imports a single Organizational Unit |
  | `aws-account` | Creates/imports a single AWS Account (this component) |
  | `aws-account-settings` | Configures account settings (IAM alias, S3 block, EBS encryption) |
  | `aws-scp` | Creates/imports Service Control Policies |

references:
  - name: cloudposse-terraform-components
    url: https://github.com/orgs/cloudposse-terraform-components/repositories
    description: Cloud Posse's upstream components
  - name: AWS Organizations Accounts
    url: https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_accounts.html
    description: AWS Organizations account management documentation
  - name: OpenTofu Import Blocks
    url: https://opentofu.org/docs/language/import/
    description: OpenTofu 1.7+ import block documentation

tags:
  - component/aws-account
  - layer/accounts
  - provider/aws
  - privileged

categories:
  - component/aws-account
  - layer/accounts
  - provider/aws
  - privileged

license: "APACHE2"

badges:
  - name: Latest Release
    image: https://img.shields.io/github/release/cloudposse-terraform-components/aws-account.svg?style=for-the-badge
    url: https://github.com/cloudposse-terraform-components/aws-account/releases/latest
  - name: Slack Community
    image: https://slack.cloudposse.com/for-the-badge.svg
    url: https://slack.cloudposse.com

related:
  - name: "Cloud Posse Terraform Modules"
    description: Our collection of reusable Terraform modules used by our reference architectures.
    url: "https://docs.cloudposse.com/modules/"
  - name: "Atmos"
    description: "Atmos is like docker-compose but for your infrastructure"
    url: "https://atmos.tools"

contributors: []
